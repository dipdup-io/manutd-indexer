spec_version: 3.0
package: manutd_indexer


database:
  kind: postgres
  host: ${POSTGRES_HOST:-db}
  port: ${POSTGRES_PORT:-5432}
  user: ${POSTGRES_USER:-dipdup}
  password: ${POSTGRES_PASSWORD:-changeme}
  database: ${POSTGRES_DB:-dipdup}


hasura:
  url: ${HASURA_URL:-http://hasura:8080}
  admin_secret: ${ADMIN_SECRET:-changeme}
  select_limit: ${SELECT_LIMIT:-10000}
  allow_aggregations: false
  rest: false

datasources:
  mainnet:
    kind: tezos.tzkt
    url: https://api.tzkt.io

  ghostnet:
    kind: tezos.tzkt
    url: https://api.ghostnet.tzkt.io


contracts:
  mu_minter_mainnet:
    kind: tezos
    address: KT1RRTZ6DGnAPYTxXx4kzzQZFiZ8yo76pULU
    typename: mu_minter

  mu_minter_ghostnet:
    kind: tezos
    address: KT1M2u4GUZsQ8BUYKTKYPEwzDYUurRtooTwn
    typename: mu_minter

indexes:
  big_maps_index_mainnet:
    kind: tezos.big_maps
    datasources:
      - mainnet
    skip_history: never
    handlers:
      - callback: on_metadata_update
        contract: mu_minter_mainnet
        path: metadata
      - callback: on_token_metadata_update
        contract: mu_minter_mainnet
        path: assets.token_metadata

  big_maps_index_ghostnet:
    kind: tezos.big_maps
    datasources:
      - ghostnet
    skip_history: never
    handlers:
      - callback: on_metadata_update
        contract: mu_minter_ghostnet
        path: metadata
      - callback: on_token_metadata_update
        contract: mu_minter_ghostnet
        path: assets.token_metadata
